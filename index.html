<!DOCTYPE html>
<html lang="en">
<head>
    <title>Pro Crypto Dashboard</title>
    <style>
        :root { --bg: #0b0e11; --card: #1e2329; --text: #eaecef; --green: #0ecb81; --red: #f6465d; }
        body { background: var(--bg); color: var(--text); font-family: sans-serif; margin: 0; padding: 20px; }
        
        /* News Ticker */
        .ticker-wrap { background: #181a20; padding: 10px; margin-bottom: 20px; border-radius: 4px; overflow: hidden; white-space: nowrap; }
        .ticker { display: inline-block; animation: marquee 30s linear infinite; color: #f0b90b; }
        @keyframes marquee { 0% { transform: translateX(100%); } 100% { transform: translateX(-100%); } }

        table { width: 100%; border-collapse: collapse; background: var(--card); border-radius: 8px; }
        th, td { padding: 16px; text-align: left; border-bottom: 1px solid #2b2f36; }
        th { color: #848e9c; font-size: 12px; text-transform: uppercase; }
        .price-up { animation: flash-green 0.5s; color: var(--green); }
        .price-down { animation: flash-red 0.5s; color: var(--red); }
        @keyframes flash-green { from { background: rgba(14, 203, 129, 0.2); } to { background: transparent; } }
        @keyframes flash-red { from { background: rgba(246, 70, 93, 0.2); } to { background: transparent; } }
    </style>
</head>
<body>

    <div class="ticker-wrap"><div class="ticker" id="news-ticker">Loading latest crypto news...</div></div>
    
    <h1>Market Overview</h1>
    <table>
        <thead>
            <tr><th>Asset</th><th>Price (USD)</th><th>24h Change</th><th>24h Range</th><th>Volume</th></tr>
        </thead>
        <tbody id="market-body"></tbody>
    </table>

    <script>
       let lastPrices = {};

        async function updateDashboard() {
            try {
                const res = await fetch('crypto.json?t=' + Date.now());
                const data = await res.json();
                
            if (data.news_ticker) {
                document.getElementById('news-ticker').innerText = 
                    data.news_ticker.map(h => `• ${h}`).join('    ');
            }

                const container = document.getElementById('market-body');
                let html = '';

                for (const [symbol, info] of Object.entries(data)) {
                    if (symbol === 'news_ticker') continue;

                    const currentPrice = parseFloat(info.price);
                    const oldPrice = lastPrices[symbol] || currentPrice;
                    let flashClass = (currentPrice > oldPrice) ? 'price-up' : (currentPrice < oldPrice ? 'price-down' : '');
                    lastPrices[symbol] = currentPrice;

                    html += `<tr>
                        <td><b>${symbol.split(':')[1]}</b></td>
                        <td class="${flashClass}">$${info.price}</td>
                        <td style="color: ${info.change_24h.includes('▲') ? 'var(--green)' : 'var(--red)'}">${info.change_24h}</td>
                        <td><small>${info.day_range}</small></td>
                        <td>${info.volume_24h || '0.00'}</td>
                    </tr>`;
                }
                container.innerHTML = html;
            } catch (e) { console.log("Waiting for data update..."); }
        }    
        setInterval(updateDashboard, 5000);
        updateDashboard();
    </script>
</body>
</html>
